<div id="section_home_categories"></div>

<section class="bg-dark py-5 text-light footer-widget">
    <div class="container">
        <div class="row">
            <div class="col-lg-5 col-xl-4 text-center text-md-left">
                <div class="mt-4">
                    <a href="#" class="d-block">
                        <img class="lazyload" src="{{ asset('public') }}/assets/img/placeholder-rect.jpg"
                             data-src="/public/uploads/all/WDUzPtHb2k2WBulYLAJpcvuRBxMo5yLeiMzDyzGb.png" alt="Shopping"
                             height="44">
                    </a>
                    <div class="my-3">
                        <p><br></p>
                        <table class="gf-t" role="presentation">
                            <tbody>
                            <tr>
                                <td colspan="2" style="padding: 1px 0px;"></td>
                            </tr>
                            <tr valign="top">
                                <td class="gf-legal"
                                    style="text-size-adjust: 100%; color: rgb(65, 65, 63); padding: 1px 0px; font-size: 11px !important;">
                                    Copyright © 2023. All rights reserved
                                </td>
                            </tr>
                            </tbody>
                        </table>
                        <p>
                        </p>
                    </div>
                    <div class="d-inline-block d-md-block mb-4">
                        <form class="form-inline" method="POST" action="/subscribers">
                            <input type="hidden" name="_token" value="oVvb046Hcw9FgwJYVjbsSE7InrxWD9HGapRVeCtY">
                            <div class="form-group mb-0">
                                <input type="email" class="form-control" placeholder="Địa chỉ email của bạn"
                                       name="email" required>
                            </div>
                            <button type="submit" class="btn btn-primary">
                                Đăng ký
                            </button>
                        </form>
                    </div>
                    <div class="w-300px mw-100 mx-auto mx-md-0">
                    </div>
                </div>
            </div>
            <div class="col-lg-3 ml-xl-auto col-md-12 mr-0">
                <div class="text-center text-md-left mt-4">
                    <h4 class="fs-13 text-uppercase fw-600 border-bottom border-gray-900 pb-2 mb-4">
                        Thông tin liên lạc
                    </h4>
                    <ul class="list-unstyled">
                        <li class="mb-2">
                            <span class="d-block opacity-30">Địa chỉ:</span>
                            <span class="d-block opacity-70">
                                Inc., 2025 Hamilton Avenue, San Jose, CA 95125, United States © 1995-2023 Inc.
                            </span>
                        </li>
                        <li class="mb-2">
                            <span class="d-block opacity-30">Số liên lạc:</span>
                            <a style="color:#fff" target="_blank" href="https://telegram.me/"
                               class="d-block opacity-70">

                            </a>
                        </li>
                        <li class="mb-2">
                            <span class="d-block opacity-30">E-mail:</span>
                            <span class="d-block opacity-70">
                                <a href="mailto:sg11@gmail.com" class="text-reset">sg11@gmail.com</a>
                            </span>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-2 col-md-12">
                <div class="text-center text-md-left">
                    <h4 class="fs-13 text-uppercase fw-600 border-bottom border-gray-900 pb-2 mb-4">
                    </h4>
                    <ul class="list-unstyled">
                    </ul>
                </div>
            </div>

            <div class="col-md-12 col-lg-2">
                <div class="text-center text-md-left mt-4">
                    <h4 class="fs-13 text-uppercase fw-600 border-bottom border-gray-900 pb-2 mb-4">
                        Tài khoản của tôi
                    </h4>
                    <ul class="list-unstyled">
                        <li class="mb-2">
                            <a class="opacity-50 hov-opacity-100 text-reset" href="/users/login">
                                Đăng nhập
                            </a>
                        </li>
                        <li class="mb-2">
                            <a class="opacity-50 hov-opacity-100 text-reset" href="/purchase_history">
                                lịch sử đơn hàng
                            </a>
                        </li>
                        <li class="mb-2">
                            <a class="opacity-50 hov-opacity-100 text-reset" href="/wishlists">
                                Sản phẩm yêu thích
                            </a>
                        </li>
                        <li class="mb-2">
                            <a class="opacity-50 hov-opacity-100 text-reset" href="/track-your-order">
                                Theo dõi thứ tự
                            </a>
                        </li>
                        <!--                             <li class="mb-2"> -->
                        <!--                                 <a class="opacity-50 hov-opacity-100 text-light" href="/affiliate">Là một đối tác liên kết</a> -->
                        <!--                             </li> -->
                    </ul>
                </div>
                <div class="text-center text-md-left mt-4">
                    <h4 class="fs-13 text-uppercase fw-600 border-bottom border-gray-900 pb-2 mb-4">
                        Hãy là người bán hàng
                    </h4>
                    <a href="/shops/create" class="btn btn-primary btn-sm shadow-md mb-4">
                        Áp dụng ngay bây giờ
                    </a>
                    <a href="/users/shops" class="btn btn-primary btn-sm shadow-md mb-4">
                        Đăng nhập người bán
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- FOOTER -->
<footer class="pt-3 pb-7 pb-xl-3 bg-black text-light">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-4">
                <div class="text-center text-md-left" current-verison="20221012">

                </div>
            </div>
            <div class="col-lg-4">
            </div>
            <div class="col-lg-4">
                <div class="text-center text-md-right">
                    <ul class="list-inline mb-0">
                        <li class="list-inline-item">
                            <img src="{{ asset('public') }}/uploads/all/A4exnDZSrAXvDu3OLWe07zbp2XXmwnQXb8iHu7jE.png"
                                 height="30" class="mw-100 h-auto" style="max-height: 30px">
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</footer>


<div class="aiz-mobile-bottom-nav d-xl-none fixed-bottom bg-white shadow-lg border-top rounded-top"
     style="box-shadow: 0px -1px 10px rgb(0 0 0 / 15%)!important; ">
    <div class="row align-items-center gutters-5">
        <div class="col">
            <a href="/" class="text-reset d-block text-center pb-2 pt-3">
                <i class="las la-home fs-20 opacity-60 opacity-100 text-primary"></i>
                <span class="d-block fs-10 fw-600 opacity-60 opacity-100 fw-600">Trang Chủ</span>
            </a>
        </div>
        <div class="col">
            <a href="/categories" class="text-reset d-block text-center pb-2 pt-3">
                <i class="las la-list-ul fs-20 opacity-60 "></i>
                <span class="d-block fs-10 fw-600 opacity-60 ">Thể loại</span>
            </a>
        </div>
        <div class="col-auto">
            <a href="/cart" class="text-reset d-block text-center pb-2 pt-3">
                <span
                    class="align-items-center bg-primary border border-white border-width-4 d-flex justify-content-center position-relative rounded-circle size-50px"
                    style="margin-top: -33px;box-shadow: 0px -5px 10px rgb(0 0 0 / 15%);border-color: #fff !important;">
                    <i class="las la-shopping-bag la-2x text-white"></i>
                </span>
                <span class="d-block mt-1 fs-10 fw-600 opacity-60 ">
                    xe đẩy
                    (<span class="cart-count">0</span>)
                </span>
            </a>
        </div>
        <div class="col">
            <a href="/#" class="text-reset d-block text-center pb-2 pt-3">
                <span class="d-inline-block position-relative px-2">
                    <i class="las la-bell fs-20 opacity-60 "></i>
                </span>
                <span class="d-block fs-10 fw-600 opacity-60 ">Thông báo</span>
            </a>
        </div>
        <div class="col">
            <a href="/users/login" class="text-reset d-block text-center pb-2 pt-3">
                <span class="d-block mx-auto">
                    <img src="{{ asset('public') }}/assets/img/avatar-place.png" class="rounded-circle size-20px">
                </span>
                <span class="d-block fs-10 fw-600 opacity-60">Tài khoản</span>
            </a>
        </div>
    </div>
</div>

</div>


<script>
    function confirm_modal(delete_url) {
        jQuery('#confirm-delete').modal('show', {
            backdrop: 'static'
        });
        document.getElementById('delete_link').setAttribute('href', delete_url);
    }
</script>

<div class="modal fade" id="confirm-delete" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">

            <div class="modal-header">

                <h4 class="modal-title" id="myModalLabel">Xác nhận</h4>
            </div>

            <div class="modal-body">
                <p>Xóa tin nhắn xác nhận</p>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Huỷ bỏ</button>
                <a id="delete_link" class="btn btn-danger btn-ok">Xóa bỏ</a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="addToCart">
    <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-zoom product-modal" id="modal-size"
         role="document">
        <div class="modal-content position-relative">
            <div class="c-preloader text-center p-3">
                <i class="las la-spinner la-spin la-3x"></i>
            </div>
            <button type="button" class="close absolute-top-right btn-icon close z-1" data-dismiss="modal"
                    aria-label="Close">
                <span aria-hidden="true" class="la-2x">&times;</span>
            </button>
            <div id="addToCart-modal-body">

            </div>
        </div>
    </div>
</div>


<!-- SCRIPTS -->
<script src="{{ asset('public') }}/assets/js/vendors.js"></script>
<script src="{{ asset('public') }}/assets/js/aiz-core.js"></script>
<script>
    $(document).ready(function () {

        // emit event iframe_change to parent window with current url
        window.parent.postMessage({
            type: 'iframe_change',
            url: window.location.href
        }, '*');

        $('.category-nav-element').each(function (i, el) {
            $(el).on('mouseover', function () {
                if (!$(el).find('.sub-cat-menu').hasClass('loaded')) {
                    $.post('/category/nav-element-list', {
                        _token: AIZ.data.csrf,
                        id: $(el).data('id')
                    }, function (data) {
                        $(el).find('.sub-cat-menu').addClass('loaded').html(data);
                    });
                }
            });
        });
        if ($('#lang-change').length > 0) {
            $('#lang-change .dropdown-menu a').each(function () {
                $(this).on('click', function (e) {
                    e.preventDefault();
                    var $this = $(this);
                    var locale = $this.data('flag');
                    $.post('/language', {
                        _token: AIZ.data.csrf,
                        locale: locale
                    }, function (data) {
                        location.reload();
                    });

                });
            });
        }

        if ($('#currency-change').length > 0) {
            $('#currency-change .dropdown-menu a').each(function () {
                $(this).on('click', function (e) {
                    e.preventDefault();
                    var $this = $(this);
                    var currency_code = $this.data('currency');
                    $.post('/currency', {
                        _token: AIZ.data.csrf,
                        currency_code: currency_code
                    }, function (data) {
                        location.reload();
                    });

                });
            });
        }
    });

    // $('#search').on('keyup', function(){
    //     search();
    // });

    // $('#search').on('focus', function(){
    //     search();
    // });

    $('#search').on('keyup focus', debounce(search, 1500));

    function debounce(func, delay) {
        let timer = null;
        return function () {
            const context = this;
            const args = arguments;
            clearTimeout(timer);
            timer = setTimeout(function () {
                func.apply(context, args);
            }, delay);
        };
    }

    function search() {
        var searchKey = $('#search').val();
        if (searchKey.length > 0) {
            $('body').addClass("typed-search-box-shown");

            $('.typed-search-box').removeClass('d-none');
            $('.search-preloader').removeClass('d-none');
            $.post('/ajax-search', {
                _token: AIZ.data.csrf,
                search: searchKey
            }, function (data) {
                if (data == '0') {
                    // $('.typed-search-box').addClass('d-none');
                    $('#search-content').html(null);
                    $('.typed-search-box .search-nothing').removeClass('d-none').html(
                        'Sorry, nothing found for <strong>"' + searchKey + '"</strong>');
                    $('.search-preloader').addClass('d-none');

                } else {
                    $('.typed-search-box .search-nothing').addClass('d-none').html(null);
                    $('#search-content').html(data);
                    $('.search-preloader').addClass('d-none');
                }
            });
        } else {
            $('.typed-search-box').addClass('d-none');
            $('body').removeClass("typed-search-box-shown");
        }
    }

    function updateNavCart(view, count) {
        $('.cart-count').html(count);
        $('#cart_items').html(view);
    }

    function removeFromCart(key) {
        console.log('key', key);

        $.get('/cart-remove', {
            id: key
        }, function (data) {
            AIZ.plugins.notify('success', "Mặt hàng đã bị xóa khỏi giỏ hàng");
            reloadCart()
            // location.reload();

            //reload page
            // updateNavCart(data.nav_cart_view, data.cart_count);
            // $('#cart-summary').html(data.cart_view);
            // AIZ.plugins.notify('success', "Mặt hàng đã bị xóa khỏi giỏ hàng");
            // $('#cart_items_sidenav').html(parseInt($('#cart_items_sidenav').html()) - 1);
        });
    }

    function removeFromCartPage(key) {
        console.log('key', key);

        $.get('/cart-remove', {
            id: key
        }, function (data) {
            AIZ.plugins.notify('success', "Mặt hàng đã bị xóa khỏi giỏ hàng");
            location.reload();

            //reload page
            // updateNavCart(data.nav_cart_view, data.cart_count);
            // $('#cart-summary').html(data.cart_view);
            // AIZ.plugins.notify('success', "Mặt hàng đã bị xóa khỏi giỏ hàng");
            // $('#cart_items_sidenav').html(parseInt($('#cart_items_sidenav').html()) - 1);
        });
    }

    function reloadCart() {
        $.get('/cart-reload', {}, function (data) {
            const content = data.content;
            const count = data.count;
            const total = data.total;
            let element = '';
            content.forEach(product => {
                element += (`<li class="list-group-item">
                        <span class="d-flex align-items-center">
                            <a href="/product/${product.id}"
                                class="text-reset d-flex align-items-center flex-grow-1">
                                <img src="${product.options.image}"
                                    data-src="${product.options.image}"
                                    class="img-fit size-60px rounded ls-is-cached lazyloaded"
                                    alt="AliToys alphabet flash cards Educational Toys Set 0-12 Months Baby Learning Language Quiet Cloth Book First Kids Soft Books Animal English Learning Card Can be washed">
                                <span class="minw-0 pl-2 flex-grow-1">
                                    <span class="fw-600 mb-1 text-truncate-2">
                                        ${product.name}
                                    </span>
                                    <span class="">${product.qty}x</span>

                                    <span class="">${'$' + product.price}</span>
                                </span>
                            </a>
                            <span class="">
                                <button onclick="removeFromCart('${product.rowId}')"
                                    class="btn btn-sm btn-icon stop-propagation">
                                    <i class="la la-close"></i>
                                </button>
                            </span>
                        </span>
                    </li>`);
            });
            $('#ul-cart').html(element);
            $('#cart-count').html(count);
            $('#cart-total').html('$' + total);
        });
    }

    function addToCompare(id) {
        $.get('/cart-compare', {
            product_id: id,
            quantity: 1
        }, function (data) {
            console.log('data', data);

            AIZ.plugins.notify('success', "Mục đã được thêm vào danh sách so sánh");
            $('#cart-compare').html(data);
        });
    }

    function addToWishList(id) {
        AIZ.plugins.notify('warning', "Vui lòng đăng nhập trước");
    }

    function showAddToCartModal(id) {
        console.log('id', id);
        $.get('/cart-add', {
            product_id: id,
            quantity: 1,

        }, function (data) {
            AIZ.plugins.notify('success', "Thêm vào giỏ hàng thành công");
            reloadCart();

        });
    }

    $('#option-choice-form input').on('change', function () {
        getVariantPrice();
    });

    function getVariantPrice() {
        if ($('#option-choice-form input[name=quantity]').val() > 0 && checkAddToCartValidity()) {
            $.ajax({
                type: "POST",
                url: '/product/variant_price',
                data: $('#option-choice-form').serializeArray(),
                success: function (data) {

                    $('.product-gallery-thumb .carousel-box').each(function (i) {
                        if ($(this).data('variation') && data.variation == $(this).data(
                            'variation')) {
                            $('.product-gallery-thumb').slick('slickGoTo', i);
                        }
                    })

                    $('#option-choice-form #chosen_price_div').removeClass('d-none');
                    $('#option-choice-form #chosen_price_div #chosen_price').html(data.price);
                    $('#available-quantity').html(data.quantity);
                    $('.input-number').prop('max', data.max_limit);
                    if (parseInt(data.in_stock) == 0 && data.digital == 0) {
                        $('.buy-now').addClass('d-none');
                        $('.add-to-cart').addClass('d-none');
                        $('.out-of-stock').removeClass('d-none');
                    } else {
                        $('.buy-now').removeClass('d-none');
                        $('.add-to-cart').removeClass('d-none');
                        $('.out-of-stock').addClass('d-none');
                    }

                    AIZ.extra.plusMinus();
                }
            });
        }
    }

    function checkAddToCartValidity() {
        var names = {};
        $('#option-choice-form input:radio').each(function () { // find unique names
            names[$(this).attr('name')] = true;
        });
        var count = 0;
        $.each(names, function () { // then count them
            count++;
        });

        if ($('#option-choice-form input:radio:checked').length == count) {
            return true;
        }

        return false;
    }

    function addToCart(id) {
        // if (checkAddToCartValidity()) {
        //     $('#addToCart').modal();
        //     $('.c-preloader').show();
        //     $.ajax({
        //         type: "POST",
        //         url: '/cart/addtocart',
        //         data: $('#option-choice-form').serializeArray(),
        //         success: function(data) {

        //             $('#addToCart-modal-body').html(null);
        //             $('.c-preloader').hide();
        //             $('#modal-size').removeClass('modal-lg');
        //             $('#addToCart-modal-body').html(data.modal_view);
        //             AIZ.extra.plusMinus();
        //             AIZ.plugins.slickCarousel();
        //             updateNavCart(data.nav_cart_view, data.cart_count);
        //         }
        //     });
        // } else {
        //     AIZ.plugins.notify('warning', "Vui lòng chọn tất cả các tùy chọn");
        // }
        $.get('/cart-add', {
            product_id: id,
            quantity: 1,

        }, function (data) {
            AIZ.plugins.notify('success', "Thêm vào giỏ hàng thành công");
            reloadCart();

        });
    }

    function buyNow() {
        if (checkAddToCartValidity()) {
            $('#addToCart-modal-body').html(null);
            $('#addToCart').modal();
            $('.c-preloader').show();
            $.ajax({
                type: "POST",
                url: '/cart/addtocart',
                data: $('#option-choice-form').serializeArray(),
                success: function (data) {
                    if (data.status == 1) {

                        $('#addToCart-modal-body').html(data.modal_view);
                        updateNavCart(data.nav_cart_view, data.cart_count);

                        window.location.replace("/cart");
                    } else {
                        $('#addToCart-modal-body').html(null);
                        $('.c-preloader').hide();
                        $('#modal-size').removeClass('modal-lg');
                        $('#addToCart-modal-body').html(data.modal_view);
                    }
                }
            });
        } else {
            AIZ.plugins.notify('warning', "Vui lòng chọn tất cả các tùy chọn");
        }
    }
</script>

</body>

</html>
